---
layout: post
title: How I set up the hotspot on Ubuntu on second attempt
date: '2011-11-25T01:14:00.000+01:00'
author: Ondrej Platek
tags:
- Hotspot
- Wi-fi
- Ubuntu
- Techtips
modified_time: '2012-07-23T17:17:21.111+02:00'
blogger_id: tag:blogger.com,1999:blog-1883852367990943689.post-511649672579981676
blogger_orig_url: http://oplatek.blogspot.com/2011/11/how-i-set-up-hotspot-on-ubuntu-on.html
---

<strong> I followed the tutorial on <br/>  <a href="http://exain.wordpress.com/2011/03/31/making-a-wifi-hotspot-access-point-using-linux-wifi-lan-cardusb-adapter/">Vivek's blog</a></strong> : <br/><p> I am writing this in order to give an example configuration for <strong>(L)Ubuntu 11.10</strong>, and <strong>counter</strong> example <strong>hostapd.conf</strong> for <strong>(L)Ubuntu 11.04</strong>.<br/>I do not want to provide another tutorial just to remember which configuration works on which (L)Ubuntu version <br/>on my <strong>Acer Aspire One 531h</strong>.<br/>The reason is that following with <strong>wpa</strong> configuration worked only after upgrade to <strong>11.10</strong><br/><p><br/>I proceed following steps(see Vivek's blog for tutorial):<br/><ol><br/>  <li>Stop the server if running. It needs sudo -i<br/><pre><br/>sudo -i<br/></pre><br/>stop dhcp server<br/><pre><br/># /etc/init.d/isc-dhcp-server stop<br/></pre><br/>or better  <br/><pre><br/># service isc-dhcp-server stop<br/></pre><br/></li><br/><li><br/>Modify /etc/hostapd/hostapd.conf and put the following.<br/><strong>The wpa settings here caused the problem!</strong><br/><pre><br/>interface=wlan0<br/>driver=nl80211<br/>ssid=MyAP<br/>hw_mode=g<br/>channel=11<br/>wpa=1<br/>wpa_passphrase=MyPasswordHere<br/>wpa_key_mgmt=WPA-PSK<br/>wpa_pairwise=TKIP CCMP<br/>wpa_ptk_rekey=600<br/></pre><br/></li><br/><li>Change the dhcpd.conf section in /etc/dhcp/dhcpd.conf (in LUbuntu 11.10 the has changed from dhcp3 in older versions)<br/><pre><br/>subnet 10.10.0.0 netmask 255.255.255.0 {<br/>        range 10.10.0.25 10.10.0.50;<br/>        option domain-name-servers 8.8.4.4, 208.67.222.222;<br/>        option routers 10.10.0.1;<br/>}<br/></pre><br/></li><br/><li><br/>Modify /etc/default/isc-dhcp-server<br/><pre><br/>INTERFACES="wlan0"<br/></pre><br/></li><br/><br/><li><br/>Configure the new interface<br/><pre><br/># ifconfig wlan0 10.10.0.1<br/></pre><br/></li><br/><br/><li><br/> Restart the isc-dhcp-server. It should now be ready to serve addresses and is also bound to the network interface too.<br/><pre><br/># /etc/init.d/isc-dhcp-server start<br/></pre><br/>or better <br/><pre><br/># service isc-dhcp-server start<br/></pre><br/></li><br/><br/><li> Allow ip masquerading<br/><pre><br/># echo "1" &gt; /proc/sys/net/ipv4/ip_forward<br/># iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE<br/></pre><br/></li><br/><li>Now start hostapd and see the messages that it shows, if you see probing. It is good:)<br/><br/><pre><br/>hostapd -dd /etc/hostapd/hostapd.conf<br/></pre><br/></li><br/><li><br/>Connect to your hotspot with username and password specified in /etc/hostapd/hostapd.conf<br/></li><br/></ol><br/><br/><h3> ADDITION: hotspot using USB Vodafone modem </h3><br/>I followed the steps mentioned above, but I changed interface <strong>eth0 to ppp0</strong> in step 7. <br/><pre><br/>$ ifconfig <br/># ... output starts with some other interfaces<br/># ..<br/><br/>ppp0      Link encap:Point-to-Point Protocol  <br/>          inet addr:10.28.2.0  P-t-P:10.64.64.64  Mask:255.255.255.255<br/>          UP POINTOPOINT RUNNING NOARP MULTICAST  MTU:1500  Metric:1<br/>          RX packets:346 errors:0 dropped:0 overruns:0 frame:0<br/>          TX packets:345 errors:0 dropped:0 overruns:0 carrier:0<br/>          collisions:0 txqueuelen:3 <br/>          RX bytes:161096 (161.0 KB)  TX bytes:55818 (55.8 KB)<br/><br/>### ... output continue with some other interfaces<br/># ..<br/></pre><br/><p><br/>In fact, I am suprised that I did not tried it before. <br/>It is so nice to have a posibility of connectiong <br/>all your devices to internet via one small USB modem and my laptop. <br/></p>